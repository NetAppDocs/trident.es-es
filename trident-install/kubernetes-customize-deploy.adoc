---
sidebar: sidebar 
permalink: trident-get-started/kubernetes-customize-deploy.html 
keywords: deploy, trident, methods, operator, tridentctl, helm, attributes, customize, tridentorchestrator, smb, windows 
summary: 'El operador Trident permite personalizar la forma en que se instala Trident mediante los atributos de la `TridentOrchestrator` especificación.' 
---
= Personalice la instalación del operador de Trident
:hardbreaks:
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
El operador Trident le permite personalizar la instalación de Trident utilizando los atributos de la `TridentOrchestrator` especificación. Si desea personalizar la instalación más allá de lo que `TridentOrchestrator` permiten los argumentos, considere utilizar `tridentctl` para generar manifiestos YAML personalizados para modificarlos según sea necesario.



== Descripción de los pods de la controladora y los pods de nodo

Trident se ejecuta como un único pod de controlador y un pod de nodo en cada nodo de trabajo del clúster. El pod del nodo debe estar ejecutándose en cualquier host donde se desee potencialmente montar un volumen Trident .

Kubernetes link:https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/["selectores de nodos"^] y.. link:https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/["toleraciones y tintes"^] se utilizan para restringir un pod para ejecutarse en un nodo concreto o preferido. Uso del "ControllerPlugin" y. `NodePlugin`, puede especificar restricciones y anulaciones.

* El complemento de la controladora se ocupa del aprovisionamiento y la gestión de volúmenes, como snapshots y redimensionamiento.
* El complemento de nodo se encarga de conectar el almacenamiento al nodo.




== Opciones de configuración


WARNING: `spec.namespace` Se especifica en `TridentOrchestrator` para indicar el espacio de nombres donde se instala Trident. Este parámetro *no se puede actualizar después de instalar Trident*. Si lo intenta, el `TridentOrchestrator` estado cambia a `Failed`. La intención de Trident no es migrar entre espacios de nombres.

Esta tabla detalla `TridentOrchestrator` atributos.

[cols="1,2,1"]
|===
| Parámetro | Descripción | Predeterminado 


| `namespace` | Espacio de nombres para instalar Trident en | `"default"` 


| `debug` | Active la depuración para Trident | `false` 


| `enableForceDetach` | `ontap-san`, `ontap-san-economy` , `ontap-nas` , y `ontap-nas-economy` solo. Funciona con Kubernetes Non-Graceful Node Shutdown (NGNS) para brindar a los administradores del clúster la capacidad de migrar de forma segura las cargas de trabajo con volúmenes montados a nuevos nodos en caso de que un nodo deje de funcionar correctamente. Para obtener más información, consultelink:../trident-reco/force-detach.html["Automatización de la conmutación por error de aplicaciones con estado con Trident"] . | `false` 


| `windows` | Ajuste a. `true` Permite la instalación en nodos de trabajo de Windows. | `false` 


| `cloudProvider`  a| 
Establecer como `"Azure"` cuando se utilizan identidades gestionadas o una identidad de nube en un clúster de AKS. Establecer como `"AWS"` cuando se utiliza una identidad de nube en un clúster de EKS. Establecer como `"GCP"` cuando se utiliza una identidad de nube en un clúster de GKE.
| `""` 


| `cloudIdentity`  a| 
Defina la identidad de carga de trabajo («azure.workload.identity/client-id: Xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx») cuando utilice la identidad de cloud en un clúster de AKS. Establezca el rol de AWS IAM ('eks.amazonaws.com/role-arn: arn:aws:iam::123456:ROLE/Trident-ROLE') cuando utilice la identidad de cloud en un clúster de EKS. Se establece en la identidad de la nube («iam.gke.io/gcp-service-account: xxxx@mygcpproject.iam.gserviceaccount.com») cuando se utiliza la identidad de la nube en un clúster de GKE.
| `""` 


| `IPv6` | Instale Trident sobre IPv6 | falso 


| `k8sTimeout`  a| 
Tiempo de espera para las operaciones de Kubernetes.


NOTE: El `k8sTimeout` El parámetro solo se aplica a la instalación de Trident .
| `180sec` 


| `silenceAutosupport` | No envíe paquetes AutoSupport a NetApp
automáticamente | `false` 


| `autosupportImage` | La imagen contenedora para telemetría AutoSupport | `"netapp/trident-autosupport10"` 


| `autosupportProxy` | La dirección/puerto de un proxy para enviar AutoSupport
Telemetría | `"http://proxy.example.com:8888"` 


| `uninstall` | Indicador utilizado para desinstalar Trident | `false` 


| `logFormat` | Formato de registro Trident que se va a utilizar [text,json] | `"text"` 


| `tridentImage` | Imagen Trident para instalar | `"netapp/trident:25.10"` 


| `imageRegistry` | Ruta de acceso al registro interno, del formato
`<registry FQDN>[:port][/subpath]` | `"registry.k8s.io"` 


| `kubeletDir` | Ruta al directorio kubelet del host | `"/var/lib/kubelet"` 


| `wipeout` | Una lista de recursos que se deben eliminar para realizar una eliminación completa de Trident |  


| `imagePullSecrets` | Secretos para extraer imágenes de un registro interno |  


| `imagePullPolicy` | Establece la política de extracción de imágenes para el operador Trident. Valores válidos:
`Always` para tirar siempre de la imagen.
`IfNotPresent` para extraer la imagen solo si aún no existe en el nodo.
`Never` para no tirar nunca de la imagen. | `IfNotPresent` 


| `controllerPluginNodeSelector` | Selectores de nodos adicionales para POD.	Sigue el mismo formato que `pod.spec.nodeSelector`. | Sin valores predeterminados; opcional 


| `controllerPluginTolerations` | Anula la toleración de Kubernetes en pods. Sigue el mismo formato que `pod.spec.Tolerations`. | Sin valores predeterminados; opcional 


| `nodePluginNodeSelector` | Selectores de nodos adicionales para POD. Sigue el mismo formato que `pod.spec.nodeSelector`. | Sin valores predeterminados; opcional 


| `nodePluginTolerations` | Anula la toleración de Kubernetes en pods. Sigue el mismo formato que `pod.spec.Tolerations`. | Sin valores predeterminados; opcional 


| `nodePrep`  a| 
Permite a Trident preparar los nodos del clúster de Kubernetes para gestionar volúmenes mediante el protocolo de almacenamiento de datos especificado. *Actualmente, `iscsi` es el único valor soportado.*


NOTE: A partir de OpenShift 4.19, la versión mínima de Trident compatible con esta función es 25.06.1.
|  


| `k8sAPIQPS`  a| 
El límite de consultas por segundo (QPS) utilizado por el controlador mientras se comunica con el servidor de API de Kubernetes.  El valor de ráfaga se establece automáticamente en función del valor QPS.
| `100`; opcional 


| `enableConcurrency`  a| 
Permite operaciones simultáneas del controlador Trident para mejorar el rendimiento.


NOTE: *Vista previa técnica*: Esta función es experimental y actualmente admite flujos de trabajo paralelos limitados con los controladores ONTAP-NAS (solo NFS) y ONTAP-SAN (NVMe para unified ONTAP 9), además de la vista previa técnica existente para el controlador ONTAP-SAN (protocolos iSCSI y FCP en unified ONTAP 9).
| falso 
|===

NOTE: Para obtener más información sobre el formato de los parámetros del pod, consulte link:https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/["Asignación de pods a nodos"^].

[WARNING]
====
* NO cambie los nombres de ningún contenedor ni campo.
* NO cambie la sangría: la sangría de YAML es fundamental para un análisis correcto.


====
[NOTE]
====
* Por defecto no se aplican límites; solo las solicitudes tienen valores predeterminados y se aplican automáticamente si no se especifican.
* Los nombres de los contenedores se enumeran tal como aparecen en las especificaciones del pod.
* Los sidecares se enumeran debajo de cada contenedor principal.
* Consulta el TORC `status.CurrentInstallationParams` campo para ver los valores aplicados actualmente.


====
a|

[source, yaml]
----
resources:
  controller:
    trident-main:
      requests:
        cpu: 10m
        memory: 80Mi
      limits:
          cpu:
          memory:
    csi-provisioner:
      requests:
        cpu: 2m
        memory: 20Mi
      limits:
        cpu:
        memory:
    csi-attacher:
      requests:
        cpu: 2m
        memory: 20Mi
      limits:
        cpu:
        memory:
    csi-resizer:
      requests:
        cpu: 3m
        memory: 20Mi
      limits:
        cpu:
        memory:
    csi-snapshotter:
      requests:
        cpu: 2m
        memory: 20Mi
      limits:
        cpu:
        memory:
    trident-autosupport:
      requests:
        cpu: 1m
        memory: 30Mi
      limits:
        cpu:
        memory:
  node:
    linux:
      trident-main:
        requests:
          cpu: 10m
          memory: 60Mi
        limits:
          cpu:
          memory:
      node-driver-registrar:
        requests:
          cpu: 1m
          memory: 10Mi
        limits:
          cpu:
          memory:
    windows:
      trident-main:
        requests:
          cpu: 6m
          memory: 40Mi
        limits:
          cpu:
          memory:
      node-driver-registrar:
        requests:
          cpu: 6m
          memory: 40Mi
        limits:
          cpu:
          memory:
      liveness-probe:
        requests:
          cpu: 2m
          memory: 40Mi
        limits:
          cpu:
          memory:
----
|`httpsMetrics`|Habilitar HTTPS para el punto de conexión de métricas de Prometheus. |falso|`hostNetwork` a|Habilita la conexión en red del host para el controlador Trident . Esto resulta útil cuando se desea separar el tráfico del frontend del tráfico del backend en una red multihome. |falso

|===


| [NOTA] Para obtener más información sobre el formato de los parámetros del pod, consultelink:https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/["Asignación de pods a nodos"^] . == Configuraciones de ejemplo Puede usar los atributos en<<Opciones de configuración>> al definir `TridentOrchestrator` para personalizar su instalación. Configuración personalizada básica [%collapsible%closed] ==== Este ejemplo, creado después de ejecutar el `cat deploy/crds/tridentorchestrator_cr_imagepullsecrets.yaml` comando, representa una instalación personalizada básica: [source,yaml] ---- apiVersion: trident.netapp.io/v1 kind: TridentOrchestrator metadata: name: trident spec: debug: true namespace: trident imagePullSecrets: - thisisasecret ---- ==== .Selectores de nodo [%collapsible%closed] ==== Este ejemplo instala Trident con selectores de nodo. [source,yaml] ---- apiVersion: trident.netapp.io/v1 kind: TridentOrchestrator metadata: name: trident spec: debug: true namespace: trident controllerPluginNodeSelector: nodetype: master nodePluginNodeSelector: storage: netapp ---- ==== Nodos de trabajo de Windows [%collapsible%closed] ==== Este ejemplo, creado después de ejecutar el `cat deploy/crds/tridentorchestrator_cr.yaml` Este comando instala Trident en un nodo de trabajo de Windows. [source,yaml] ---- apiVersion: trident.netapp.io/v1 kind: TridentOrchestrator metadata: name: trident spec: debug: true namespace: trident windows: true ---- ==== Identidades administradas en un clúster de AKS [%collapsible%closed] ==== Este ejemplo instala Trident para habilitar identidades administradas en un clúster de AKS. [source,yaml] ---- apiVersion: trident.netapp.io/v1 kind: TridentOrchestrator metadata: name: trident spec: debug: true namespace: trident cloudProvider: "Azure" ---- ==== .Identidad en la nube en un clúster de AKS [%collapsible%closed] ==== Este ejemplo instala Trident para usarlo con una identidad en la nube en un clúster de AKS. [source,yaml] ---- apiVersion: trident.netapp.io/v1 kind: TridentOrchestrator metadata: name: trident spec: debug: true namespace: trident cloudProvider: "Azure" cloudIdentity: 'azure.workload.identity/client-id: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx' ---- ==== Identidad en la nube en un clúster EKS [%collapsible%closed] ==== Este ejemplo instala Trident para usarlo con una identidad en la nube en un clúster AKS. [source,yaml] ---- apiVersion: trident.netapp.io/v1 kind: TridentOrchestrator metadata: name: trident spec: debug: true namespace: trident cloudProvider: "AWS" cloudIdentity: "'eks.amazonaws.com/role-arn: arn:aws:iam::123456:role/trident-role'" ---- ==== Identidad en la nube para GKE [%collapsible%closed] ==== Este ejemplo instala Trident para usarlo con una identidad en la nube en un clúster de GKE. [source,yaml] ---- apiVersion: trident.netapp.io/v1 kind: TridentBackendConfig metadata: name: backend-tbc-gcp-gcnv spec: version: 1 storageDriverName: google-cloud-netapp-volumes projectNumber: '012345678901' network: gcnv-network location: us-west2 serviceLevel: Premium storagePool: pool-premium1 ---- ==== .Configuración de solicitudes y límites de recursos de Kubernetes para el controlador Trident y los pods de nodos Linux de Trident [%collapsible%closed] ==== Este ejemplo configura las solicitudes y los límites de recursos de Kubernetes para el controlador Trident y los pods de nodos Linux de Trident . ADVERTENCIA: *Descargo de responsabilidad*: Los valores de solicitud y límite proporcionados en este ejemplo son solo para fines demostrativos. Ajuste estos valores según las necesidades de su entorno y carga de trabajo. [source,yaml] ---- apiVersion: trident.netapp.io/v1 kind: TridentOrchestrator metadata: name: trident spec: debug: true namespace: trident imagePullSecrets: - thisisasecret resources: controller: trident-main: requests: cpu: 10m memory: 80Mi limits: cpu: 200m memory: 256Mi # sidecars csi-provisioner: requests: cpu: 2m memory: 20Mi limits: cpu: 100m memory: 64Mi csi-attacher: requests: cpu: 2m memory: 20Mi limits: cpu: 100m memory: 64Mi csi-resizer: requests: cpu: 3m memory: 20Mi limits: cpu: 100m memory: 64Mi csi-snapshotter: requests: cpu: 2m memory: 20Mi limits: cpu: Memoria de 100m: 64Mi trident-autosupport: solicitudes: cpu: 1m memoria: 30Mi límites: cpu: 50m memoria: 128Mi nodo: linux: trident-main: solicitudes: cpu: 10m memoria: 60Mi límites: cpu: 200m memoria: 256Mi # sidecars node-driver-registrar: solicitudes: cpu: 1m memoria: 10Mi límites: cpu: 50m memoria: 32Mi ---- ==== .Configuración de solicitudes y límites de recursos de Kubernetes para el controlador Trident y los pods de nodos Trident Windows y Linux [%collapsible%closed] ==== Este ejemplo configura las solicitudes y los límites de recursos de Kubernetes para el controlador Trident y los pods de nodos Trident Windows y Linux. ADVERTENCIA: *Descargo de responsabilidad*: Los valores de solicitud y límite proporcionados en este ejemplo son solo para fines demostrativos. Ajuste estos valores según las necesidades de su entorno y carga de trabajo. [source,yaml] ---- apiVersion: trident.netapp.io/v1 kind: TridentOrchestrator metadata: name: trident spec: debug: true namespace: trident imagePullSecrets: - thisisasecret windows: true resources: controller: trident-main: requests: cpu: 10m memory: 80Mi limits: cpu: 200m memoria: 256 Mi # sidecars csi-provisioner: solicitudes: cpu: 2 m memoria: 20 Mi límites: cpu: 100 m memoria: 64 Mi csi-attacher: solicitudes: cpu: 2 m memoria: 20 Mi límites: cpu: 100 m memoria: 64 Mi csi-resizer: solicitudes: cpu: 3 m memoria: 20 Mi límites: cpu: 100 m memoria: 64 Mi csi-snapshotter: solicitudes: cpu: 2 m memoria: 20 Mi límites: cpu: 100 m memoria: 64 Mi trident-autosupport: solicitudes: cpu: 1 m memoria: 30 Mi límites: cpu: 50 m memoria: 128 Mi node: linux: trident-main: solicitudes: cpu: 10 m memoria: 60 Mi límites: cpu: 200 m memoria: 256 Mi # sidecars node-driver-registrar: solicitudes: cpu: 1m memoria: 10Mi límites: cpu: 50m memoria: 32Mi windows: trident-main: solicitudes: cpu: 6m memoria: 40Mi límites: cpu: 200m memoria: 128Mi # sidecars node-driver-registrar: solicitudes: cpu: 6m memoria: 40Mi límites: cpu: 100m memoria: 128Mi liveness-probe: solicitudes: cpu: 2m memoria: 40Mi límites: cpu: 50m memoria: 64Mi ---- ==== 
|===